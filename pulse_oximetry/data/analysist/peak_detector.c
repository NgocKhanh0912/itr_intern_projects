/**
 * @file       peak_detector.c
 * @copyright  Copyright (C) 2019 ITRVN. All rights reserved.
 * @license    This project is released under the Fiot License.
 * @version    v1.0.0
 * @date       2024-07-29
 * @author     Giang Phan Truong
 *             Khanh Nguyen Ngoc
 *             Viet Hoang Xuan
 *
 * @brief      None
 *
 * @note
 * @example    None
 */

/* Includes ----------------------------------------------------------- */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
#include <math.h>

/* Private defines ---------------------------------------------------- */
#define MAX_SAMPLES (2000)

/* Private enumerate/structure ---------------------------------------- */

/* Private macros ----------------------------------------------------- */

/* Public variables --------------------------------------------------- */
const char *data_file = "../golden_data/filtered_golden_data.csv";
double sample[MAX_SAMPLES] = {7.727940275249999859e-03,
                              6.737955452723820571e-02,
                              2.954134841425977709e-01,
                              8.893145585289922161e-01,
                              2.107682706672234119e+00,
                              4.244629194116102511e+00,
                              7.608299270259579750e+00,
                              1.250311019997334583e+01,
                              1.921540758813651451e+01,
                              2.800224293367437056e+01,
                              3.908266061662615698e+01,
                              5.263058971394715968e+01,
                              6.876903615977886375e+01,
                              8.756644160834375157e+01,
                              1.090361808749562584e+02,
                              1.331390175917175611e+02,
                              1.597876054285088969e+02,
                              1.888526599782581172e+02,
                              2.201706945890909424e+02,
                              2.535522636959692022e+02,
                              2.887892561759069849e+02,
                              3.256605708801671426e+02,
                              3.639361497530853171e+02,
                              4.033797207583000954e+02,
                              4.437509878330461106e+02,
                              4.848078260811258247e+02,
                              5.263085300105183251e+02,
                              5.680140551060692360e+02,
                              6.096902489623259953e+02,
                              6.511099912093613966e+02,
                              6.920550431250231895e+02,
                              7.323171680331879543e+02,
                              7.716982061344347130e+02,
                              8.100096937927595491e+02,
                              8.470732386980157571e+02,
                              8.827222938311217604e+02,
                              9.168049972031723200e+02,
                              9.491874720462169535e+02,
                              9.797574231780569107e+02,
                              1.008427843893499585e+03,
                              1.035139931975631498e+03,
                              1.059864174068938610e+03,
                              1.082599183689889969e+03,
                              1.103368804633409582e+03,
                              1.122218531626916956e+03,
                              1.139211855028264608e+03,
                              1.154426710860540879e+03,
                              1.167952209120845964e+03,
                              1.179885705489593875e+03,
                              1.190330237374505032e+03,
                              1.199392270919540351e+03,
                              1.207179254721030702e+03,
                              1.213796314410574723e+03,
                              1.219342507759676664e+03,
                              1.223908146851929814e+03,
                              1.227574130944711214e+03,
                              1.230412996354916686e+03,
                              1.232490981703996567e+03,
                              1.233870858889302326e+03,
                              1.234615395489969160e+03,
                              1.234790531416583008e+03,
                              1.234467161945720363e+03,
                              1.233721269345828659e+03,
                              1.232632590585586968e+03,
                              1.231282150371103853e+03,
                              1.229749475692789929e+03,
                              1.228110266034089591e+03,
                              1.226434663466418669e+03,
                              1.224785977981015094e+03,
                              1.223219795817953127e+03,
                              1.221783438485552551e+03,
                              1.220515373964950186e+03,
                              1.219443920778643133e+03,
                              1.218585381781906108e+03,
                              1.217942687710846258e+03,
                              1.217505554542128721e+03,
                              1.217252349426542878e+03,
                              1.217153122094413447e+03,
                              1.217173385876632210e+03,
                              1.217278609185484811e+03,
                              1.217438748236918173e+03,
                              1.217631566827648385e+03,
                              1.217844142711130644e+03,
                              1.218072650683078564e+03,
                              1.218320755056519374e+03,
                              1.218597325009592168e+03,
                              1.218914235611690629e+03,
                              1.219284568352758015e+03,
                              1.219721176400962122e+03,
                              1.220235532581090865e+03,
                              1.220836831935289410e+03,
                              1.221531147455408245e+03,
                              1.222320076663298096e+03,
                              1.223198637592981640e+03,
                              1.224153351496722962e+03,
                              1.225161825749629543e+03,
                              1.226194067393358637e+03,
                              1.227214995598712449e+03,
                              1.228187825021839672e+03,
                              1.229078073999921116e+03,
                              1.229857662604218831e+03,
                              1.230508215951820148e+03,
                              1.231022688156367167e+03,
                              1.231405036025709251e+03,
                              1.231668400674910572e+03,
                              1.231832576907620478e+03,
                              1.231921465846648971e+03,
                              1.231960921225055245e+03,
                              1.231977059880200159e+03,
                              1.231994903902349051e+03,
                              1.232037279342698866e+03,
                              1.232123893879990419e+03,
                              1.232270127829261128e+03,
                              1.232485020686998269e+03,
                              1.232768994549927811e+03,
                              1.233112743647770458e+03,
                              1.233498009241178124e+03,
                              1.233899762127532085e+03,
                              1.234289174188725156e+03,
                              1.234637291708976591e+03,
                              1.234919223023292261e+03,
                              1.235117877026927090e+03,
                              1.235226168979310842e+03,
                              1.235247377825697868e+03,
                              1.235193907665021015e+03,
                              1.235085001653950258e+03,
                              1.234944226256545335e+03,
                              1.234797259085465612e+03,
                              1.234670043240573477e+03,
                              1.234587332203056576e+03,
                              1.234571634237138824e+03,
                              1.234642386109970175e+03,
                              1.234814922076900984e+03,
                              1.235098701018208885e+03,
                              1.235495046194146653e+03,
                              1.235995650971685336e+03,
                              1.236582753883433725e+03,
                              1.237230858679841731e+03,
                              1.237909531689507730e+03,
                              1.238586999843554167e+03,
                              1.239234288130356163e+03,
                              1.239829122767873287e+03,
                              1.240358548084811900e+03,
                              1.240819796886704353e+03,
                              1.241219521888770942e+03,
                              1.241571756446318886e+03,
                              1.241895373578555564e+03,
                              1.242211779073672687e+03,
                              1.242543056151684141e+03,
                              1.242910468906148935e+03,
                              1.243333231149830681e+03,
                              1.243827592077364443e+03,
                              1.244406023655683157e+03,
                              1.245075800716718504e+03,
                              1.245836887452848259e+03,
                              1.246680237650487925e+03,
                              1.247587584617578614e+03,
                              1.248532836259266787e+03,
                              1.249484596165384119e+03,
                              1.250409453302630027e+03,
                              1.251275910780047070e+03,
                              1.252058442491926371e+03,
                              1.252740643291272818e+03,
                              1.253316670305198841e+03,
                              1.253790862924066005e+03,
                              1.254175931984989347e+03,
                              1.254490500687294343e+03,
                              1.254756795440289579e+03,
                              1.254998714105467570e+03,
                              1.255240165240639271e+03,
                              1.255503720840494907e+03,
                              1.255809639413762397e+03,
                              1.256175030802246511e+03,
                              1.256612553175873927e+03,
                              1.257128244854915465e+03,
                              1.257719355085079769e+03,
                              1.258373637699707615e+03,
                              1.259070421460516627e+03,
                              1.259782781012111855e+03,
                              1.260480392478565818e+03,
                              1.261133205712586914e+03,
                              1.261715731900775154e+03,
                              1.262210778618408312e+03,
                              1.262611501955639596e+03,
                              1.262921565143023599e+03,
                              1.263153721487697567e+03,
                              1.263327426564084817e+03,
                              1.263466298105863189e+03,
                              1.263595938821826167e+03,
                              1.263742113907870362e+03,
                              1.263929190889130041e+03,
                              1.264178958365593644e+03,
                              1.264509790798471158e+03,
                              1.264935602421313888e+03,
                              1.265463992985068671e+03,
                              1.266094003298918778e+03,
                              1.266814845301776586e+03,
                              1.267606419330225435e+03,
                              1.268441254695667340e+03,
                              1.269287301021186749e+03,
                              1.270111523991367449e+03,
                              1.270884208966362166e+03,
                              1.271582983070120463e+03,
                              1.272195398641768634e+03,
                              1.272719797890427344e+03,
                              1.273164478491808723e+03,
                              1.273545409180154365e+03,
                              1.273883538448682884e+03,
                              1.274202555688563280e+03,
                              1.274527106003099107e+03,
                              1.274881322282446945e+03,
                              1.275287716190779065e+03,
                              1.275766323527346685e+03,
                              1.276333710394590753e+03,
                              1.277001338932268482e+03,
                              1.277773332245808888e+03,
                              1.278644734459433039e+03,
                              1.279601433656755034e+03,
                              1.280621775090941128e+03,
                              1.281679189049748857e+03,
                              1.282745490574286578e+03,
                              1.283794862534151889e+03,
                              1.284807972270976734e+03,
                              1.285775007494804868e+03,
                              1.286696874692807796e+03,
                              1.287584685093338976e+03,
                              1.288457990488522228e+03,
                              1.289342392868840307e+03,
                              1.290267214053747693e+03,
                              1.291263546263465742e+03,
                              1.292362655215895302e+03,
                              1.293594659361158847e+03,
                              1.294987438245877911e+03,
                              1.296565603431952695e+03,
                              1.298349067342385297e+03,
                              1.300351030517950448e+03,
                              1.302576198553219001e+03,
                              1.305020295158343288e+03,
                              1.307671137700549480e+03,
                              1.310510927548584732e+03,
                              1.313519414819026224e+03,
                              1.316677706552232394e+03,
                              1.319972242242048651e+03,
                              1.323398125812790113e+03,
                              1.326961058788650462e+03,
                              1.330677349516374306e+03,
                              1.334572065882764946e+03,
                              1.338676306484634551e+03,
                              1.343024692196053365e+03,
                              1.347653460291310921e+03,
                              1.352598861777644743e+03,
                              1.357895615732174065e+03,
                              1.363575595288457407e+03,
                              1.369666793157236270e+03,
                              1.376192160441318720e+03,
                              1.383167784430828760e+03,
                              1.390600706964344454e+03,
                              1.398487715075897540e+03,
                              1.406815939326560283e+03,
                              1.415564896230043587e+03,
                              1.424709385607141257e+03,
                              1.434223064728613508e+03,
                              1.444082444886284520e+03,
                              1.454270562116116707e+03,
                              1.464779451510416266e+03,
                              1.475610844734516149e+03,
                              1.486775054294653046e+03,
                              1.498288668493936484e+03,
                              1.510172000132251696e+03,
                              1.522446956445467322e+03,
                              1.535135434187536248e+03,
                              1.548258011128937596e+03,
                              1.561832740258440253e+03,
                              1.575874036324556755e+03,
                              1.590391512614683279e+03,
                              1.605388294405962824e+03,
                              1.620858873665601777e+03,
                              1.636787590852417225e+03,
                              1.653148708719213573e+03,
                              1.669908050516436333e+03,
                              1.687025696160670577e+03,
                              1.704459463396583260e+03,
                              1.722168956074520565e+03,
                              1.740119469468432499e+03,
                              1.758284777023765855e+03,
                              1.776648183368873106e+03,
                              1.795201826104290603e+03,
                              1.813944773979541196e+03,
                              1.832880695544364016e+03,
                              1.852015628736152848e+03,
                              1.871356069814946295e+03,
                              1.890907421117475678e+03,
                              1.910672748174486969e+03,
                              1.930651786433373445e+03,
                              1.950840020565293116e+03,
                              1.971227371258052017e+03,
                              1.991796229779707119e+03,
                              2.012519649273441701e+03,
                              2.033360982097395663e+03,
                              2.054275272421283262e+03,
                              2.075211835335361684e+03,
                              2.096117595633698784e+03,
                              2.116941012781721383e+03,
                              2.137636073541059886e+03,
                              2.158165393967508862e+03,
                              2.178501780212703579e+03,
                              2.198628195922710802e+03,
                              2.218536269851234465e+03,
                              2.238223822575264421e+03,
                              2.257692406327970730e+03,
                              2.276945427668718366e+03,
                              2.295986568107120547e+03,
                              2.314818362525849807e+03,
                              2.333441185740838591e+03,
                              2.351852546704732049e+03,
                              2.370046115295608615e+03,
                              2.388009975500747714e+03,
                              2.405724550097161682e+03,
                              2.423161571295198428e+03,
                              2.440284898190590411e+03,
                              2.457052710091878907e+03,
                              2.473420415671483170e+03,
                              2.489344336516634030e+03,
                              2.504786076498016882e+03,
                              2.519716316500735957e+03,
                              2.534116771809287457e+03,
                              2.547980293157793312e+03,
                              2.561309571808279088e+03,
                              2.574114876518183337e+03,
                              2.586411539160777465e+03,
                              2.598217781776806532e+03,
                              2.609552943574492929e+03,
                              2.620435976601271250e+03,
                              2.630884201875609506e+03,
                              2.640912346333389905e+03,
                              2.650531528429050013e+03,
                              2.659747607452093689e+03,
                              2.668559095247669575e+03,
                              2.676955831633552407e+03,
                              2.684919295234300080e+03,
                              2.692424386468965167e+03,
                              2.699442148382891901e+03,
                              2.705943206648727937e+03,
                              2.711901785495718286e+03,
                              2.717299518276444815e+03,
                              2.722127970401822495e+03,
                              2.726389407828404728e+03,
                              2.730095930103838327e+03,
                              2.733267424156266316e+03,
                              2.735929115158478908e+03,
                              2.738109341077760291e+03,
                              2.739837686546806708e+03,
                              2.741143420140082071e+03,
                              2.742054242716711542e+03,
                              2.742595329810966632e+03,
                              2.742788410434319758e+03,
                              2.742650342026013277e+03,
                              2.742191059760153166e+03,
                              2.741411811911724726e+03,
                              2.740304797321476144e+03,
                              2.738854425258256924e+03,
                              2.737039701878666165e+03,
                              2.734837381682008981e+03,
                              2.732225878648373055e+03,
                              2.729189499128645821e+03,
                              2.725721684960411494e+03,
                              2.721826290780335967e+03,
                              2.717517098064126003e+03,
                              2.712816080097590202e+03,
                              2.707750938001651321e+03,
                              2.702352638773595118e+03,
                              2.696653399490886386e+03,
                              2.690685147983525894e+03,
                              2.684478296438891448e+03,
                              2.678060618936635365e+03,
                              2.671456163250793907e+03,
                              2.664684012264084231e+03,
                              2.657756520019048367e+03,
                              2.650677351491217905e+03,
                              2.643440577031098201e+03,
                              2.636031584570576342e+03,
                              2.628429398333072641e+03,
                              2.620609858747926864e+03,
                              2.612549596408982325e+03,
                              2.604230314470652047e+03,
                              2.595642167329233416e+03,
                              2.586785418012179434e+03,
                              2.577670361224393218e+03,
                              2.568315854407547704e+03,
                              2.558747002718698241e+03,
                              2.548992696295986207e+03,
                              2.539083551423912468e+03,
                              2.529050296721447012e+03,
                              2.518922426411382730e+03,
                              2.508727227729382321e+03,
                              2.498489118215195958e+03,
                              2.488228602141534338e+03,
                              2.477960233438107025e+03,
                              2.467690117316661599e+03,
                              2.457414475543554090e+03,
                              2.447120181855918872e+03,
                              2.436786793309250243e+03,
                              2.426389340213342621e+03,
                              2.415901810890358320e+03,
                              2.405301273292393489e+03,
                              2.394571723586644566e+03,
                              2.383706572415132996e+03,
                              2.372709450067119178e+03,
                              2.361593502575658476e+03,
                              2.350379432118078057e+03,
                              2.339092836972758505e+03,
                              2.327761615946036272e+03,
                              2.316413889369431672e+03,
                              2.305076470804284327e+03,
                              2.293773781790447629e+03,
                              2.282527053606971549e+03,
                              2.271353366780423130e+03,
                              2.260263938523663001e+03,
                              2.249261912839942852e+03,
                              2.238340835702065306e+03,
                              2.227484731722135621e+03,
                              2.216669844766695860e+03,
                              2.205867504739283504e+03,
                              2.195047615044302347e+03,
                              2.184182587976881223e+03,
                              2.173251254321788565e+03,
                              2.162241722820801897e+03,
                              2.151152471730769321e+03,
                              2.139991792992126648e+03,
                              2.128776069618431393e+03,
                              2.117527394223819556e+03,
                              2.106271105175755110e+03,
                              2.095033658729897525e+03,
                              2.083840963199480939e+03,
                              2.072717116045755574e+03,
                              2.061683418190792963e+03,
                              2.050757469742073226e+03,
                              2.039951867527788181e+03,
                              2.029272170547412088e+03,
                              2.018714881620162942e+03,
                              2.008266781625595740e+03,
                              1.997906060076987160e+03,
                              1.987604726025222590e+03,
                              1.977331830066947532e+03,
                              1.967057401758923106e+03,
                              1.956756732958475368e+03,
                              1.946413912449024110e+03,
                              1.936023607124374621e+03,
                              1.925590833942409290e+03,
                              1.915129082990501047e+03,
                              1.904657741544243436e+03,
                              1.894199665686204298e+03,
                              1.883779028928492608e+03,
                              1.873419422634792681e+03,
                              1.863142416095339740e+03,
                              1.852966704900264403e+03,
                              1.842907577892642621e+03,
                              1.832976031572322427e+03,
                              1.823177003964293135e+03,
                              1.813507239744553317e+03,
                              1.803954125544690669e+03,
                              1.794496272680834863e+03,
                              1.785105529307078086e+03,
                              1.775749835833280713e+03,
                              1.766396898759004898e+03,
                              1.757018546237254895e+03,
                              1.747594500825995283e+03,
                              1.738114383377457216e+03,
                              1.728578047617214679e+03,
                              1.718994637088684613e+03,
                              1.709380648571989468e+03,
                              1.699757602921821217e+03,
                              1.690149825614298152e+03,
                              1.680582502198230713e+03,
                              1.671080065268120961e+03,
                              1.661664980486322520e+03,
                              1.652356877190246450e+03,
                              1.643171561519981424e+03,
                              1.634119295297739654e+03,
                              1.625202511146190545e+03,
                              1.616414172717848260e+03,
                              1.607737805185399111e+03,
                              1.599149139627882278e+03,
                              1.590618865289584164e+03,
                              1.582116246805030414e+03,
                              1.573613352354836024e+03,
                              1.565089121716757518e+03,
                              1.556532300425564472e+03,
                              1.547942697545247938e+03,
                              1.539330508099664257e+03,
                              1.530713969701129599e+03,
                              1.522116562085632722e+03,
                              1.513564687575156086e+03,
                              1.505085709673043766e+03,
                              1.496706132053102010e+03,
                              1.488450214845139271e+03,
                              1.480339200517021254e+03,
                              1.472390673658496553e+03,
                              1.464617386299178634e+03,
                              1.457025394596551905e+03,
                              1.449612181907022659e+03,
                              1.442365923417077965e+03,
                              1.435266532515886865e+03,
                              1.428288105137821503e+03,
                              1.421402181789709630e+03,
                              1.414581639939512115e+03,
                              1.407804765717186228e+03,
                              1.401058537724329426e+03,
                              1.394340311028561700e+03,
                              1.387657650467265967e+03,
                              1.381026600336980437e+03,
                              1.374469155209113296e+03,
                              1.368010761731881303e+03,
                              1.361678218251959606e+03,
                              1.355497954385919684e+03,
                              1.349494637386910426e+03,
                              1.343690113888707629e+03,
                              1.338102598092447806e+03,
                              1.332745605908120297e+03,
                              1.327626097510714317e+03,
                              1.322742338117403506e+03,
                              1.318082819413977177e+03,
                              1.313626946851897401e+03,
                              1.309347151581123853e+03,
                              1.305211902585174357e+03,
                              1.301189511252245666e+03,
                              1.297252434884882177e+03,
                              1.293381004594468777e+03,
                              1.289565573574823247e+03,
                              1.285806871074297078e+03,
                              1.282114777716551089e+03,
                              1.278506065862593459e+03,
                              1.275001926884970317e+03,
                              1.271625812941672393e+03,
                              1.268401643437955045e+03,
                              1.265352303397322430e+03,
                              1.262498452820471357e+03,
                              1.259857670174669693e+03,
                              1.257443526516186921e+03,
                              1.255263872931142487e+03,
                              1.253318517409557899e+03,
                              1.251597593176131340e+03,
                              1.250081632651634209e+03,
                              1.248743265266920389e+03,
                              1.247549950146332549e+03,
                              1.246467512433002184e+03,
                              1.245464398869422894e+03,
                              1.244515783149750177e+03,
                              1.243606282742149915e+03,
                              1.242730848936816756e+03,
                              1.241894044066896186e+03,
                              1.241108049839214573e+03,
                              1.240390085986357917e+03,
                              1.239760005908334279e+03,
                              1.239238312183274275e+03,
                              1.238844551397443183e+03,
                              1.238596081280533099e+03,
                              1.238507069053724535e+03,
                              1.238587451891183036e+03,
                              1.238841487983599109e+03,
                              1.239265868205715378e+03,
                              1.239848219471134144e+03,
                              1.240566971699887290e+03,
                              1.241392859777663944e+03,
                              1.242291649438773220e+03,
                              1.243227562730617137e+03,
                              1.244167205709738255e+03,
                              1.245083512294429966e+03,
                              1.245958669129002828e+03,
                              1.246785381505110081e+03,
                              1.247566496451985131e+03,
                              1.248313249827268010e+03,
                              1.249042761690830957e+03,
                              1.249775582023847846e+03,
                              1.250533663686061118e+03,
                              1.251338687649413259e+03,
                              1.252210684963466065e+03,
                              1.253167050406458202e+03,
                              1.254221691662726244e+03,
                              1.255383676148606128e+03,
                              1.256655211905371743e+03,
                              1.258029709455673583e+03,
                              1.259491027634719785e+03,
                              1.261014439653800309e+03,
                              1.262568955155354161e+03,
                              1.264120442395729469e+03,
                              1.265635422251789350e+03,
                              1.267085189614696446e+03,
                              1.268449274660692026e+03,
                              1.269717467459180625e+03,
                              1.270890159147321356e+03,
                              1.271977021000033346e+03,
                              1.272994596819267372e+03,
                              1.273963712011159487e+03,
                              1.274907200223432028e+03,
                              1.275848057204285851e+03,
                              1.276807999678725537e+03,
                              1.277806299920183847e+03,
                              1.278858808992438298e+03,
                              1.279976941538266146e+03,
                              1.281166028428298659e+03,
                              1.282423078731107807e+03,
                              1.283735285851309072e+03,
                              1.285080393695706334e+03,
                              1.286428649639547530e+03,
                              1.287745604251872464e+03,
                              1.288995625536507760e+03,
                              1.290146160275247212e+03,
                              1.291171888387735635e+03,
                              1.292057470542799592e+03,
                              1.292798341741872264e+03,
                              1.293399751045663379e+03,
                              1.293874616422696818e+03,
                              1.294241032381593413e+03,
                              1.294520053677216765e+03,
                              1.294733838864765630e+03,
                              1.294904066774015064e+03,
                              1.295050690685779955e+03,
                              1.295191039274240211e+03,
                              1.295338881603199297e+03,
                              1.295502824621736181e+03,
                              1.295684096836357639e+03,
                              1.295874856731440104e+03,
                              1.296058042229802140e+03,
                              1.296208782392322973e+03,
                              1.296296965605713922e+03,
                              1.296290684492085347e+03,
                              1.296160315615788932e+03,
                              1.295882622294562225e+03,
                              1.295443766277788200e+03,
                              1.294840436104583205e+03,
                              1.294079271652435864e+03,
                              1.293175135504228592e+03,
                              1.292148727705316787e+03,
                              1.291024191068446953e+03,
                              1.289827167745405177e+03,
                              1.288583206724049433e+03,
                              1.287316304786812225e+03,
                              1.286047726702224054e+03,
                              1.284795089204918440e+03,
                              1.283571017406692590e+03,
                              1.282381040534165095e+03,
                              1.281221651434514570e+03,
                              1.280079787015324428e+03,
                              1.278934063574097536e+03,
                              1.277757193527416575e+03,
                              1.276519106249259949e+03,
                              1.275190754488016864e+03,
                              1.273748224839910563e+03,
                              1.272176090188715534e+03,
                              1.270469143576490524e+03,
                              1.268632401051942907e+03,
                              1.266679672620301972e+03,
                              1.264631223928459121e+03,
                              1.262511259370996413e+03,
                              1.260345748195233000e+03,
                              1.258160670104233304e+03,
                              1.255980617437966885e+03,
                              1.253827754138945011e+03,
                              1.251721027532467360e+03,
                              1.249675120824957958e+03,
                              1.247698568450638277e+03,
                              1.245791444088479238e+03,
                              1.243943989366954156e+03,
                              1.242137118734896376e+03,
                              1.240344517796027048e+03,
                              1.238535587280789514e+03,
                              1.236679078298388959e+03,
                              1.234747340147858267e+03,
                              1.232720176380381872e+03,
                              1.230587168850796843e+03,
                              1.228348166587178184e+03,
                              1.226012137325629737e+03,
                              1.223594961404544392e+03,
                              1.221117057151056088e+03,
                              1.218601295085720267e+03,
                              1.216071191151569792e+03,
                              1.213549454383879947e+03,
                              1.211056937697659123e+03,
                              1.208611795740851448e+03,
                              1.206228468467338416e+03,
                              1.203916015506065833e+03,
                              1.201675924526808330e+03,
                              1.199500525774896232e+03,
                              1.197373044944283265e+03,
                              1.195269252215812458e+03,
                              1.193160141312096130e+03,
                              1.191015385124648674e+03,
                              1.188807460067391048e+03,
                              1.186515752326709844e+03,
                              1.184129468832407838e+03,
                              1.181648620417461188e+03,
                              1.179083121054371531e+03,
                              1.176450578087149097e+03,
                              1.173773667588743137e+03,
                              1.171077739439831930e+03,
                              1.168388801584405428e+03,
                              1.165731901132768371e+03,
                              1.163129922559977331e+03,
                              1.160602704503982977e+03,
                              1.158166131616957500e+03,
                              1.155830709845633919e+03,
                              1.153599556177043269e+03,
                              1.151466641768258569e+03,
                              1.149416422379910500e+03,
                              1.147425169662378266e+03,
                              1.145463495323424240e+03,
                              1.143499607603673439e+03,
                              1.141503157925578307e+03,
                              1.139449262071865178e+03,
                              1.137321739704347920e+03,
                              1.135114736770561194e+03,
                              1.132832534385204781e+03,
                              1.130487918476725099e+03,
                              1.128099848609581613e+03,
                              1.125691073597939521e+03,
                              1.123286005818159083e+03,
                              1.120909006050962944e+03,
                              1.118583056796224355e+03,
                              1.116328687169635941e+03,
                              1.114163033468446429e+03,
                              1.112098661505774317e+03,
                              1.110141699980656540e+03,
                              1.108289753258434303e+03,
                              1.106530894708684627e+03,
                              1.104844437713703883e+03,
                              1.103203088791929986e+03,
                              1.101575903105668203e+03,
                              1.099931936231600275e+03,
                              1.098244351222619116e+03,
                              1.096494011296063491e+03,
                              1.094671654911232963e+03,
                              1.092778397550701357e+03,
                              1.090824637463200816e+03,
                              1.088827837149815650e+03,
                              1.086810006934838839e+03,
                              1.084795456298893214e+03,
                              1.082808917382146092e+03,
                              1.080874048172554922e+03,
                              1.079012328256037108e+03,
                              1.077242196109086308e+03,
                              1.075578007944407545e+03,
                              1.074028298595150090e+03,
                              1.072593578790412266e+03,
                              1.071264906089969827e+03,
                              1.070024159930659835e+03,
                              1.068845891477583791e+03,
                              1.067700180312304838e+03,
                              1.066556132435345035e+03,
                              1.065385840077281955e+03,
                              1.064168181271606045e+03,
                              1.062891439444266325e+03,
                              1.061554200287447657e+03,
                              1.060164546916306335e+03,
                              1.058737930176794407e+03,
                              1.057294547189015930e+03,
                              1.055857011893930803e+03,
                              1.054448505750213371e+03,
                              1.053091245252632234e+03,
                              1.051805240424049316e+03,
                              1.050607445518952318e+03,
                              1.049511018415586477e+03,
                              1.048523999220742326e+03,
                              1.047647200504583452e+03,
                              1.046872249494443167e+03,
                              1.046181170675097746e+03,
                              1.045547928910923929e+03,
                              1.044941178461808704e+03,
                              1.044327563216488215e+03,
                              1.043675619352290141e+03,
                              1.042959961638042842e+03,
                              1.042164580222859513e+03,
                              1.041284340352700838e+03,
                              1.040324623299801260e+03,
                              1.039299546221317541e+03,
                              1.038229491243739858e+03,
                              1.037138664612991761e+03,
                              1.036053002489437858e+03,
                              1.034998385374000236e+03,
                              1.033999143066436318e+03,
                              1.033076942039630694e+03,
                              1.032249892568406267e+03,
                              1.031531257551858289e+03,
                              1.030927348995113562e+03,
                              1.030435382526163266e+03,
                              1.030042708698435945e+03,
                              1.029727902305868611e+03,
                              1.029463124733441191e+03,
                              1.029217215008860876e+03,
                              1.028959511357843894e+03,
                              1.028664114718478004e+03,
                              1.028313358943136336e+03,
                              1.027899474351111166e+03,
                              1.027424509592442519e+03,
                              1.026898952611035384e+03,
                              1.026339532331760438e+03,
                              1.025766834103263591e+03,
                              1.025203216733263162e+03,
                              1.024671170649365195e+03,
                              1.024192044988584712e+03,
                              1.023785001307021275e+03,
                              1.023466058828800328e+03,
                              1.023247042643642203e+03,
                              1.023134022767328702e+03,
                              1.023125266652511186e+03,
                              1.023209815572740808e+03,
                              1.023367763069890202e+03,
                              1.023572177398081180e+03,
                              1.023792047780287589e+03,
                              1.023995936086521738e+03,
                              1.024156091967350221e+03,
                              1.024252227217182281e+03,
                              1.024273949763312885e+03,
                              1.024221399073442399e+03,
                              1.024104210366759162e+03,
                              1.023939366966964144e+03,
                              1.023748729123971088e+03,
                              1.023556769254274286e+03,
                              1.023388632961011467e+03,
                              1.023268514614154014e+03,
                              1.023218364763349541e+03,
                              1.023256934899103385e+03,
                              1.023398838141782335e+03,
                              1.023652975161877634e+03,
                              1.024020315938359317e+03,
                              1.024492169346469382e+03,
                              1.025050103967634186e+03,
                              1.025667600173715527e+03,
                              1.026312819693584061e+03,
                              1.026952144775822944e+03,
                              1.027554292442818678e+03,
                              1.028094286996520623e+03,
                              1.028556341497145695e+03,
                              1.028935114917848978e+03,
                              1.029235289347802336e+03,
                              1.029469856052372506e+03,
                              1.029657791451483035e+03,
                              1.029821716558796652e+03,
                              1.029985865332034336e+03,
                              1.030174426817173980e+03,
                              1.030410206602209655e+03,
                              1.030713591446587770e+03,
                              1.031101591719489761e+03,
                              1.031586341227431149e+03,
                              1.032172874057461286e+03,
                              1.032857161022076525e+03,
                              1.033625616077846189e+03,
                              1.034456322249669483e+03,
                              1.035321476225115020e+03,
                              1.036190611616885008e+03,
                              1.037034417236731315e+03,
                              1.037828743161900547e+03,
                              1.038557891899930610e+03,
                              1.039216341427400494e+03,
                              1.039808664617034538e+03,
                              1.040347949743180379e+03,
                              1.040853354684088345e+03,
                              1.041347622741720670e+03,
                              1.041855094238050697e+03,
                              1.042400095895934101e+03,
                              1.043005492271990988e+03,
                              1.043691537362922872e+03,
                              1.044475075712833359e+03,
                              1.045368557909422407e+03,
                              1.046378201294170140e+03,
                              1.047501724881878317e+03,
                              1.048727056557970627e+03,
                              1.050032810735768180e+03,
                              1.051390249598717674e+03,
                              1.052766195165181671e+03,
                              1.054126832240615840e+03,
                              1.055442117530087444e+03,
                              1.056689572383986615e+03,
                              1.057856559410742648e+03,
                              1.058940999051477775e+03,
                              1.059950480301736889e+03,
                              1.060900089254891100e+03,
                              1.061809905808031999e+03,
                              1.062702764907850906e+03,
                              1.063602282994418147e+03,
                              1.064531186289247216e+03,
                              1.065510073938603455e+03,
                              1.066556538189507137e+03,
                              1.067684209185946202e+03,
                              1.068901120409490431e+03,
                              1.070207572714409707e+03,
                              1.071594637506851541e+03,
                              1.073044153837715157e+03,
                              1.074530255371953444e+03,
                              1.076022088810516834e+03,
                              1.077487421508708849e+03,
                              1.078896815143173171e+03,
                              1.080227583876977860e+03,
                              1.081466486249559694e+03,
                              1.082610635093163637e+03,
                              1.083666787642307554e+03,
                              1.084649440018078622e+03,
                              1.085578375529393725e+03,
                              1.086476345820564802e+03,
                              1.087367142495939788e+03,
                              1.088273998843237223e+03,
                              1.089218301399519987e+03,
                              1.090218660761094043e+03,
                              1.091290147381844690e+03,
                              1.092443091736857923e+03,
                              1.093681088538030963e+03,
                              1.094998991002541970e+03,
                              1.096382260695964305e+03,
                              1.097808146287401087e+03,
                              1.099248211971679893e+03,
                              1.100671668092940763e+03,
                              1.102049190985298083e+03,
                              1.103356771024222780e+03,
                              1.104578746888825663e+03,
                              1.105709388948657988e+03,
                              1.106752851792904494e+03,
                              1.107721590504169853e+03,
                              1.108633970640403732e+03,
                              1.109512026146411699e+03,
                              1.110379574828402838e+03,
                              1.111260484970984635e+03,
                              1.112177136214660095e+03,
                              1.113149255566507463e+03,
                              1.114193056818665582e+03,
                              1.115320114706100867e+03,
                              1.116535472855326589e+03,
                              1.117835601267490347e+03,
                              1.119207517389033910e+03,
                              1.120629584104287915e+03,
                              1.122073533861527494e+03,
                              1.123507301660696157e+03,
                              1.124898714509359706e+03,
                              1.126219810979617250e+03,
                              1.127450674921246900e+03,
                              1.128581649748568907e+03,
                              1.129613749383512641e+03,
                              1.130557631517401887e+03,
                              1.131431435202597640e+03,
                              1.132258086828539035e+03,
                              1.133062933717862052e+03,
                              1.133871838021620533e+03,
                              1.134709471343275482e+03,
                              1.135598009825989266e+03,
                              1.136556274688820167e+03,
                              1.137598737081470290e+03,
                              1.138733816612302462e+03,
                              1.139961804489114229e+03,
                              1.141273567014895434e+03,
                              1.142650810925789983e+03,
                              1.144067817100761204e+03,
                              1.145494216532721566e+03,
                              1.146898580197669162e+03,
                              1.148252597348674499e+03,
                              1.149534982548374501e+03,
                              1.150734043718843168e+03,
                              1.151848528311210202e+03,
                              1.152886848975952034e+03,
                              1.153865043744632203e+03,
                              1.154804261303466546e+03,
                              1.155728490609805704e+03,
                              1.156662699802034240e+03,
                              1.157631301215988742e+03,
                              1.158656928872700973e+03,
                              1.159759503256353810e+03,
                              1.160955264326869838e+03,
                              1.162255196854697715e+03,
                              1.163662846255176646e+03,
                              1.165172597844192296e+03,
                              1.166769555207464009e+03,
                              1.168431142233373521e+03,
                              1.170129832913411065e+03,
                              1.171836579061222437e+03,
                              1.173524825389825082e+03,
                              1.175174560971332994e+03,
                              1.176775361846802070e+03,
                              1.178327760688134276e+03,
                              1.179842791052828943e+03,
                              1.181340011596428894e+03,
                              1.182844946433685664e+03,
                              1.184386773929052197e+03,
                              1.185996418445059817e+03,
                              1.187704970173355377e+03,
                              1.189542417713425948e+03,
                              1.191536587734853128e+03,
                              1.193712089729957825e+03,
                              1.196089006563110161e+03,
                              1.198681093806571425e+03,
                              1.201493927267206573e+03,
                              1.204524208187765453e+03,
                              1.207760755733800352e+03,
                              1.211186596594970752e+03,
                              1.214781895589620945e+03,
                              1.218527926003991524e+03,
                              1.222411388753376968e+03,
                              1.226427768143741332e+03,
                              1.230583063527642253e+03,
                              1.234893855219367424e+03,
                              1.239385864230438528e+03,
                              1.244091600686443144e+03,
                              1.249047909649728354e+03,
                              1.254293793483180707e+03,
                              1.259868498503315550e+03,
                              1.265809853164150354e+03,
                              1.272152915843643768e+03,
                              1.278928937641877383e+03,
                              1.286164280126990207e+03,
                              1.293878634707610672e+03,
                              1.302082788787306527e+03,
                              1.310777326563762017e+03,
                              1.319953119761671132e+03,
                              1.329593260558709062e+03,
                              1.339675867755623131e+03,
                              1.350177618728483139e+03,
                              1.361077813915145498e+03,
                              1.372362108922780408e+03,
                              1.384024900773555146e+03,
                              1.396069979372886792e+03,
                              1.408509550105563449e+03,
                              1.421362121710183828e+03,
                              1.434650070977464793e+03,
                              1.448397423699701903e+03,
                              1.462627946263422928e+03,
                              1.477363550163602667e+03,
                              1.492623052753119282e+03,
                              1.508421239109198041e+03,
                              1.524767883167098034e+03,
                              1.541666206919242313e+03,
                              1.559110720245883385e+03,
                              1.577085417493929754e+03,
                              1.595563627774635734e+03,
                              1.614509739084159946e+03,
                              1.633881981303022940e+03,
                              1.653635755492846783e+03,
                              1.673727532722025899e+03,
                              1.694118801573405563e+03,
                              1.714779025883015265e+03,
                              1.735687024784969481e+03,
                              1.756830605266896328e+03,
                              1.778204673401067566e+03,
                              1.799808780221939514e+03,
                              1.821644932706971986e+03,
                              1.843715727099903233e+03,
                              1.866022730817867568e+03,
                              1.888565212374568773e+03,
                              1.911339254150541137e+03,
                              1.934336962670862249e+03,
                              1.957545173283510621e+03,
                              1.980943503803139947e+03,
                              2.004502548646724790e+03,
                              2.028183268284018368e+03,
                              2.051938049532913283e+03,
                              2.075713131364784203e+03,
                              2.099451875981185822e+03,
                              2.123098670607606437e+03,
                              2.146603036074583088e+03,
                              2.169922922968436524e+03,
                              2.193026424501980728e+03,
                              2.215891867714792170e+03,
                              2.238506546482932208e+03,
                              2.260864557504571167e+03,
                              2.282964399094823875e+03,
                              2.304806866257710681e+03,
                              2.326393423921067551e+03,
                              2.347724945204194228e+03,
                              2.368800665526381636e+03,
                              2.389617268108889220e+03,
                              2.410167774344186000e+03,
                              2.430439766586408950e+03,
                              2.450413338870960615e+03,
                              2.470060079085842517e+03,
                              2.489343743478426404e+03,
                              2.508222172181005590e+03,
                              2.526650004040253407e+03,
                              2.544582299892719220e+03,
                              2.561978813173032904e+03,
                              2.578807638527197014e+03,
                              2.595047240680262348e+03,
                              2.610686932675307617e+03,
                              2.625725969613896268e+03,
                              2.640171503124381161e+03,
                              2.654036211391086454e+03,
                              2.667336154252152483e+03,
                              2.680088827811371630e+03,
                              2.692311588253844093e+03,
                              2.704020667090281677e+03,
                              2.715230443674494836e+03,
                              2.725952345228996819e+03,
                              2.736192989562659022e+03,
                              2.745951924018996579e+03,
                              2.755220087199292720e+03,
                              2.763979890387298838e+03,
                              2.772206862730927242e+03,
                              2.779872340252367394e+03,
                              2.786946884241071984e+03,
                              2.793404221614663129e+03,
                              2.799225062232402252e+03,
                              2.804399810317273023e+03,
                              2.808929580758651809e+03,
                              2.812825528855087214e+03,
                              2.816106907623978259e+03,
                              2.818798584478151497e+03,
                              2.820928702468972460e+03,
                              2.822526787609997882e+03,
                              2.823622248995127848e+03,
                              2.824243143324359153e+03,
                              2.824415244813443678e+03,
                              2.824161269274147344e+03,
                              2.823499573424859136e+03,
                              2.822441969168032301e+03,
                              2.820991600990775623e+03,
                              2.819142323920743365e+03,
                              2.816879945720912929e+03,
                              2.814184730769775342e+03,
                              2.811034687260715600e+03,
                              2.807409496231754929e+03,
                              2.803294641448790117e+03,
                              2.798684731989505963e+03,
                              2.793585127839021425e+03,
                              2.788011642018243947e+03,
                              2.781988706743908551e+03,
                              2.775546803402833120e+03,
                              2.768719907401587079e+03,
                              2.761543367290744754e+03,
                              2.754052294014467407e+03,
                              2.746280314109061237e+03,
                              2.738258623915964563e+03,
                              2.730015163409096203e+03,
                              2.721573320369767316e+03,
                              2.712949846249555776e+03,
                              2.704152705841109764e+03,
                              2.695180101452961026e+03,
                              2.686021256644144160e+03,
                              2.676658583544869543e+03,
                              2.667070605242870442e+03,
                              2.657235508111596573e+03,
                              2.647135253756936436e+03,
                              2.636759302328774538e+03,
                              2.626106793777867097e+03,
                              2.615186914416159652e+03,
                              2.604017740537606187e+03,
                              2.592624070612027026e+03,
                              2.581035042722578510e+03,
                              2.569282021954704305e+03,
                              2.557396721677320784e+03,
                              2.545409624145266207e+03,
                              2.533348862805973113e+03,
                              2.521239437940847893e+03,
                              2.509102280007341506e+03,
                              2.496952551086507356e+03,
                              2.484797369138653266e+03,
                              2.472634254321698791e+03,
                              2.460451363664841665e+03,
                              2.448229420526866306e+03,
                              2.435944706145886812e+03,
                              2.423572736536524644e+03,
                              2.411092331717009074e+03,
                              2.398489300768963858e+03,
                              2.385758852913812007e+03,
                              2.372906364519730232e+03,
                              2.359946515498319059e+03,
                              2.346901148194480811e+03,
                              2.333796646598591451e+03,
                              2.320661576950781637e+03,
                              2.307524834202420607e+03,
                              2.294414196186266963e+03,
                              2.281355130808867671e+03,
                              2.268369830318729328e+03,
                              2.255476377167170995e+03,
                              2.242687484641984156e+03,
                              2.230008508477639225e+03,
                              2.217435690324084590e+03,
                              2.204955898857665943e+03,
                              2.192548047019723072e+03,
                              2.180185655926476102e+03,
                              2.167840185319119882e+03,
                              2.155484928450025564e+03,
                              2.143098908438983017e+03,
                              2.130669731530218996e+03,
                              2.118194695846841569e+03,
                              2.105680255954890526e+03,
                              2.093140316510442062e+03,
                              2.080594024009616533e+03,
                              2.068063700576565680e+03,
                              2.055573062835900146e+03,
                              2.043145622323522730e+03,
                              2.030803346691874594e+03,
                              2.018565675863488195e+03,
                              2.006448693101739082e+03,
                              1.994463902041242818e+03,
                              1.982616262966062550e+03,
                              1.970902092303226482e+03,
                              1.959308074772389773e+03,
                              1.947812108774597391e+03,
                              1.936385612873146101e+03,
                              1.924996609131415880e+03,
                              1.913613502308029865e+03,
                              1.902209332390501231e+03,
                              1.890765329545635268e+03,
                              1.879272810816574292e+03,
                              1.867733422124442768e+03,
                              1.856157934026370640e+03,
                              1.844563942610695449e+03,
                              1.832973282127184575e+03,
                              1.821409819014407731e+03,
                              1.809897734400295121e+03,
                              1.798460133693435864e+03,
                              1.787117894714306431e+03,
                              1.775888722923480600e+03,
                              1.764786100751919548e+03,
                              1.753817578366914177e+03,
                              1.742982605998785402e+03,
                              1.732271253890462958e+03,
                              1.721664795875568416e+03,
                              1.711137777618644122e+03,
                              1.700660864219252744e+03,
                              1.690204315541880987e+03,
                              1.679741935954974679e+03,
                              1.669254705392986125e+03,
                              1.658733171513269099e+03,
                              1.648178185099752909e+03,
                              1.637599972708059113e+03,
                              1.627015957671666001e+03,
                              1.616448177964580736e+03,
                              1.605920982134957057e+03,
                              1.595459146641567713e+03,
                              1.585086346593457847e+03,
                              1.574823952971720246e+03,
                              1.564690112772505245e+03,
                              1.554698803162240210e+03,
                              1.544858322837806554e+03,
                              1.535169254338741894e+03,
                              1.525622914491969368e+03,
                              1.516201361750098386e+03,
                              1.506879075467839584e+03,
                              1.497625721487161627e+03,
                              1.488409630749458302e+03,
                              1.479201842864105174e+03,
                              1.469980072775278586e+03,
                              1.460731522948769452e+03,
                              1.451453890107075040e+03,
                              1.442154746601496527e+03,
                              1.432849797360361435e+03,
                              1.423560510400603562e+03,
                              1.414311752194027804e+03,
                              1.405129860277052785e+03,
                              1.396041055726340574e+03,
                              1.387070036110796309e+03,
                              1.378238881005291432e+03,
                              1.369566131983536025e+03,
                              1.361065377767729387e+03,
                              1.352743101813071689e+03,
                              1.344596752214890103e+03,
                              1.336614299799473883e+03,
                              1.328775519291571072e+03,
                              1.321054425961670177e+03,
                              1.313422482890071024e+03,
                              1.305852476499049999e+03,
                              1.298322568758888110e+03,
                              1.290819473115459914e+03,
                              1.283339968441019664e+03,
                              1.275890728548290554e+03,
                              1.268486864542152034e+03,
                              1.261149692153881460e+03,
                              1.253904259675352932e+03,
                              1.246777077122745141e+03,
                              1.239794305372167855e+03,
                              1.232980493726044642e+03,
                              1.226357719075948580e+03,
                              1.219944831061513923e+03,
                              1.213756390105296759e+03,
                              1.207800732987406718e+03,
                              1.202077523142239443e+03,
                              1.196576402989987855e+03,
                              1.191277690828475443e+03,
                              1.186154592810910572e+03,
                              1.181176245118705992e+03,
                              1.176311479411412165e+03,
                              1.171533092534629986e+03,
                              1.166821617591161157e+03,
                              1.162167516551237441e+03,
                              1.157571522683091416e+03,
                              1.153043402743285242e+03,
                              1.148599683821242706e+03,
                              1.144261159750073148e+03,
                              1.140050731483554046e+03,
                              1.135991682796201076e+03,
                              1.132106378070541268e+03,
                              1.128415179290457672e+03,
                              1.124935330726335451e+03,
                              1.121679746174982938e+03,
                              1.118655395629641589e+03,
                              1.115861241550438763e+03,
                              1.113286747950522567e+03,
                              1.110912048378479994e+03,
                              1.108709793827958947e+03,
                              1.106648055346954379e+03,
                              1.104693894877297225e+03,
                              1.102817455527348102e+03,
                              1.100995851007224246e+03,
                              1.099215746059315279e+03,
                              1.097474173950406566e+03,
                              1.095777719878679818e+03,
                              1.094140430665181384e+03,
                              1.092581253702212280e+03,
                              1.091121749570521843e+03,
                              1.089784221584169245e+03,
                              1.088590194295642959e+03,
                              1.087559253792896698e+03,
                              1.086708171265032888e+03,
                              1.086049966593941917e+03,
                              1.085592342581350749e+03,
                              1.085335422272971300e+03,
                              1.085269943067404711e+03,
                              1.085377215355814997e+03,
                              1.085630823921203046e+03,
                              1.085999262451600316e+03,
                              1.086449155732415875e+03,
                              1.086949105968937147e+03,
                              1.087473642566357285e+03,
                              1.088006139952183503e+03,
                              1.088539980844941510e+03,
                              1.089078112947338241e+03,
                              1.089631490642188510e+03,
                              1.090216868030116530e+03,
                              1.090854416403729601e+03,
                              1.091565565385269110e+03,
                              1.092371262629480043e+03,
                              1.093290638407638426e+03,
                              1.094340023229116696e+03,
                              1.095532183404770421e+03,
                              1.096875168935591319e+03,
                              1.098370296911390597e+03,
                              1.100010026921200279e+03,
                              1.101777107300169519e+03,
                              1.103645534550261800e+03,
                              1.105582860054439607e+03,
                              1.107553275741126072e+03,
                              1.109521357741472229e+03,
                              1.111456201097498933e+03,
                              1.113334974313871726e+03,
                              1.115144888656136573e+03,
                              1.116883335702372960e+03,
                              1.118556624650808999e+03,
                              1.120177931817829858e+03,
                              1.121765001691640236e+03,
                              1.123338018930007820e+03,
                              1.124917791599969632e+03,
                              1.126524163110377003e+03,
                              1.128174706635142229e+03,
                              1.129883792164513352e+03,
                              1.131661529186379084e+03,
                              1.133511910802699731e+03,
                              1.135430653947670635e+03,
                              1.137404059630518077e+03,
                              1.139409490967671900e+03,
                              1.141417171732908628e+03,
                              1.143392929445577010e+03,
                              1.145301790786033735e+03,
                              1.147112146120982970e+03,
                              1.148799580812539261e+03,
                              1.150349466161571854e+03,
                              1.151757948957399549e+03,
                              1.153031286379328321e+03,
                              1.154183797771107493e+03,
                              1.155235228670915603e+03,
                              1.156208309634871057e+03,
                              1.157126748246009811e+03,
                              1.158013633748029861e+03,
                              1.158890229373274906e+03,
                              1.159775036823221626e+03,
                              1.160682762435934364e+03,
                              1.161622596833160515e+03,
                              1.162595934905115882e+03,
                              1.163594743820553958e+03,
                              1.164601563565941888e+03,
                              1.165591117948421470e+03,
                              1.166533008431626513e+03,
                              1.167395161391592865e+03,
                              1.168147920294156393e+03,
                              1.168768064720827397e+03,
                              1.169241526118434194e+03,
                              1.169564301853353527e+03,
                              1.169741933621196040e+03,
                              1.169787961954676575e+03,
                              1.169721768032074579e+03,
                              1.169566336174189473e+03,
                              1.169346235068864644e+03,
                              1.169085896814111720e+03,
                              1.168808295429953432e+03,
                              1.168534035850656437e+03,
                              1.168280469964171743e+03,
                              1.168060189405319079e+03,
                              1.167878790213316051e+03,
                              1.167732829878843859e+03,
                              1.167609127282232748e+03,
                              1.167485686463349793e+03,
                              1.167333929688089938e+03,
                              1.167122063955018348e+03,
                              1.166819265839390482e+03,
                              1.166399861000257715e+03,
                              1.165846503378050102e+03,
                              1.165151846016835634e+03,
                              1.164318709225085740e+03,
                              1.163358792622536839e+03,
                              1.162290312196022569e+03,
                              1.161135485920194924e+03,
                              1.159918501560822733e+03,
                              1.158663892135670267e+03,
                              1.157395150738316261e+03,
                              1.156133652509507556e+03,
                              1.154897792636681061e+03,
                              1.153701847307423577e+03,
                              1.152554050362345606e+03,
                              1.151454275393512262e+03,
                              1.150392762311749038e+03,
                              1.149350833625507221e+03,
                              1.148303074785198532e+03,
                              1.147220179492072930e+03,
                              1.146072519319187450e+03,
                              1.144834423152690761e+03,
                              1.143487961148251088e+03,
                              1.142025017236056101e+03,
                              1.140447606226086918e+03,
                              1.138766754262142058e+03,
                              1.137000312776989631e+03,
                              1.135170461916617796e+03,
                              1.133301503902407148e+03,
                              1.131418060120220161e+03,
                              1.129543613865656880e+03,
                              1.127699379334447030e+03,
                              1.125903450801554982e+03,
                              1.124169873534639464e+03,
                              1.122507064203392929e+03,
                              1.120915702134576804e+03,
                              1.119387198302963725e+03,
                              1.117903740239998115e+03,
                              1.116439997967584077e+03,
                              1.114965994126020178e+03,
                              1.113450733518751349e+03,
                              1.111866315270900031e+03,
                              1.110191823467859876e+03,
                              1.108416075293244376e+03,
                              1.106538740479610169e+03,
                              1.104569653773535720e+03,
                              1.102526598541310250e+03,
                              1.100432573443697947e+03,
                              1.098313389924790499e+03,
                              1.096195684898865920e+03,
                              1.094105189333421549e+03,
                              1.092065288050872368e+03,
                              1.090095986754224214e+03,
                              1.088213029733053872e+03,
                              1.086426561435309395e+03,
                              1.084739269331497098e+03,
                              1.083144817343319119e+03,
                              1.081627481520271203e+03,
                              1.080163331355646733e+03,
                              1.078722651309128196e+03,
                              1.077273213327949634e+03,
                              1.075784228391216175e+03,
                              1.074230408868926133e+03,
                              1.072595144456226990e+03,
                              1.070872111525479340e+03,
                              1.069065123323816351e+03,
                              1.067186429749526269e+03,
                              1.065254195916494155e+03,
                              1.063290098203970047e+03,
                              1.061317483020130567e+03,
                              1.059359892909041719e+03,
                              1.057439741643476282e+03,
                              1.055577187326248804e+03,
                              1.053789189402394413e+03,
                              1.052088331503392737e+03,
                              1.050480894382933911e+03,
                              1.048964672143229109e+03,
                              1.047527956080301010e+03,
                              1.046150385514598838e+03,
                              1.044805173313951400e+03,
                              1.043462101389739018e+03,
                              1.042091193979710624e+03,
                              1.040666846675075249e+03,
                              1.039171408065325295e+03,
                              1.037597207542078650e+03,
                              1.035946812207773746e+03,
                              1.034231742101057307e+03,
                              1.032470141045193031e+03,
                              1.030684198669873467e+03,
                              1.028897959837799590e+03,
                              1.027135634943046625e+03,
                              1.025420222296713291e+03,
                              1.023772318132481359e+03,
                              1.022209081502472031e+03,
                              1.020743208635546580e+03,
                              1.019381517487790802e+03,
                              1.018123138467886292e+03,
                              1.016958302796219300e+03,
                              1.015868646361456399e+03,
                              1.014828920448490976e+03,
                              1.013809650207639379e+03,
                              1.012780649801848426e+03,
                              1.011715183284521572e+03,
                              1.010593793647391863e+03,
                              1.009406725433338579e+03,
                              1.008154587287847562e+03,
                              1.006847363790667600e+03,
                              1.005502218500074491e+03,
                              1.004140926696360225e+03,
                              1.002787570727248067e+03,
                              1.001466668986604191e+03,
                              1.000201785964718852e+03,
                              9.990145038660646151e+02,
                              9.979234745850484387e+02,
                              9.969433096500192732e+02,
                              9.960829690438964690e+02,
                              9.953436389216878979e+02,
                              9.947170822353399444e+02,
                              9.941855703805023268e+02,
                              9.937234605846589375e+02,
                              9.932998285878842353e+02,
                              9.928817653660022415e+02,
                              9.924382103274625706e+02,
                              9.919439498172297363e+02,
                              9.913827316327088965e+02,
                              9.907484989948802649e+02,
                              9.900449362466617913e+02,
                              9.892840124325689430e+02,
                              9.884838534498938998e+02,
                              9.876664414380144308e+02,
                              9.868556704043446643e+02,
                              9.860757518299452613e+02,
                              9.853497837394581893e+02,
                              9.846985242495643433e+02,
                              9.841393020083417014e+02,
                              9.836845281232702973e+02,
                              9.833395056959921021e+02,
                              9.831003785352310160e+02,
                              9.829535578939215839e+02,
                              9.828769731154061446e+02,
                              9.828423256105152177e+02,
                              9.828178248830297434e+02,
                              9.827718553137311801e+02,
                              9.826774396471889759e+02,
                              9.825160658449681250e+02,
                              9.822797089329432083e+02,
                              9.819708764495442210e+02,
                              9.816009961712965151e+02,
                              9.811879215614462737e+02,
                              9.807534431102131975e+02,
                              9.803211931521113911e+02,
                              9.799149577960253055e+02,
                              9.795573019597691200e+02,
                              9.792684065445687338e+02,
                              9.790650620971123317e+02,
                              9.789595135219653912e+02,
                              9.789576740730686879e+02,
                              9.790570405006671990e+02,
                              9.792455662568564776e+02,
                              9.795022959880432154e+02,
                              9.797994938973249646e+02,
                              9.801056914335221109e+02,
                              9.803894209774240380e+02,
                              9.806234260554147113e+02,
                              9.807885198994350731e+02,
                              9.808759242515666301e+02,
                              9.808875815293232563e+02,
                              9.808348015442577434e+02,
                              9.807359148416968537e+02,
                              9.806136832007624662e+02,
                              9.804930695475462699e+02,
                              9.803994880050657912e+02,
                              9.803573278205670931e+02,
                              9.803886706569870739e+02,
                              9.805122966683195500e+02,
                              9.807426954730743773e+02,
                              9.810884600266114148e+02,
                              9.815502256272894783e+02,
                              9.821192651684195880e+02,
                              9.827775804056722109e+02,
                              9.834994977559712197e+02,
                              9.842543389479887992e+02,
                              9.850098554417271544e+02,
                              9.857362364275647906e+02,
                              9.864100088564863427e+02,
                              9.870168661130502414e+02,
                              9.875528730016442296e+02,
                              9.880239059422890477e+02,
                              9.884436881017483074e+02,
                              9.888312974003611089e+02,
                              9.892088387759692978e+02,
                              9.895994514284597017e+02,
                              9.900256781608281926e+02,
                              9.905082491220101701e+02,
                              9.910652135307526578e+02,
                              9.917110274713568288e+02,
                              9.924550150014404153e+02,
                              9.932993229675354314e+02,
                              9.942374033414117775e+02,
                              9.952538491762971944e+02,
                              9.963256118192958866e+02,
                              9.974242607141931103e+02,
                              9.985190928864053603e+02,
                              9.995809569275413651e+02,
                              1.000586210380955322e+03,
                              1.001519898258428270e+03,
                              1.002377374044473640e+03,
                              1.003164017122801738e+03,
                              1.003893533950537631e+03,
                              1.004585784506933919e+03,
                              1.005264600807388433e+03,
                              1.005955692310234781e+03,
                              1.006684815292541657e+03,
                              1.007476311482828919e+03,
                              1.008351912240634874e+03,
                              1.009329645812821241e+03,
                              1.010422503844373068e+03,
                              1.011636479191005492e+03,
                              1.012968496692075632e+03,
                              1.014405494859726787e+03,
                              1.015925249229323185e+03,
                              1.017498534480376748e+03,
                              1.019092065377114977e+03,
                              1.020672165770149718e+03,
                              1.022209036451228258e+03,
                              1.023680587989639776e+03,
                              1.025074669713727417e+03,
                              1.026389420517490862e+03,
                              1.027632121382442620e+03,
                              1.028817086715100686e+03,
                              1.029963234061663798e+03,
                              1.031091916837295685e+03,
                              1.032225202023850670e+03,
                              1.033384497023618223e+03,
                              1.034589469605997238e+03,
                              1.035857148703555140e+03,
                              1.037200896572125657e+03,
                              1.038628798054836125e+03,
                              1.040141571497535097e+03,
                              1.041731125463262288e+03,
                              1.043380714249828543e+03,
                              1.045066567886584153e+03,
                              1.046760499847852316e+03,
                              1.048433293062110806e+03,
                              1.050058646417239288e+03,
                              1.051616956302777453e+03,
                              1.053097923274946424e+03,
                              1.054501377024188059e+03,
                              1.055836421637574404e+03,
                              1.057119441234633996e+03,
                              1.058371653185101422e+03,
                              1.059616778332311242e+03,
                              1.060879067658696840e+03,
                              1.062181747461380382e+03,
                              1.063545864333322243e+03,
                              1.064989386840712996e+03,
                              1.066526292096735460e+03,
                              1.068165159481837691e+03,
                              1.069907156605310320e+03,
                              1.071744341630548888e+03,
                              1.073659414053085811e+03,
                              1.075627120599519458e+03,
                              1.077616824540924881e+03,
                              1.079595870165028373e+03,
                              1.081533603607212171e+03,
                              1.083405427981651428e+03,
                              1.085195770585148466e+03,
                              1.086899322570065124e+03,
                              1.088520617479101475e+03,
                              1.090072269835423413e+03,
                              1.091572513889665288e+03,
                              1.093042894200216779e+03,
                              1.094506446926139688e+03,
                              1.095986146665115939e+03,
                              1.097503540404379237e+03,
                              1.099077721417025259e+03,
                              1.100724503576645247e+03,
                              1.102455179975196643e+03,
                              1.104274509173647857e+03,
                              1.106178709113822151e+03,
                              1.108154700216532092e+03,
                              1.110181021571427209e+03,
                              1.112230052697911105e+03,
                              1.114271087606869514e+03,
                              1.116274089272891160e+03,
                              1.118213818534208713e+03,
                              1.120073289928921440e+03,
                              1.121845527310552370e+03,
                              1.123533527226485148e+03,
                              1.125148786390688656e+03,
                              1.126708903612241556e+03,
                              1.128235105244778424e+03,
                              1.129750285087191060e+03,
                              1.131277435045460152e+03,
                              1.132838230118791671e+03,
                              1.134451866674874964e+03,
                              1.136134207309199155e+03,
                              1.137896749341063696e+03,
                              1.139744755016348336e+03,
                              1.141674929812316805e+03,
                              1.143674134913775106e+03,
                              1.145720075182878873e+03,
                              1.147783561447980901e+03,
                              1.149831581891801761e+03,
                              1.151830984270120098e+03,
                              1.153752636099329266e+03,
                              1.155575220883059046e+03,
                              1.157287659039286382e+03,
                              1.158889774909637254e+03,
                              1.160391300165189023e+03,
                              1.161809649607532265e+03,
                              1.163167296150099673e+03,
                              1.164489386128824208e+03,
                              1.165801749343279880e+03,
                              1.167129300818562115e+03,
                              1.168494831207263587e+03,
                              1.169918094610573917e+03,
                              1.171414824836861044e+03,
                              1.172995147443280985e+03,
                              1.174661473627382520e+03,
                              1.176406916370764520e+03,
                              1.178215274315188253e+03,
                              1.180062672725235643e+03,
                              1.181920249340506416e+03,
                              1.183757509430213759e+03,
                              1.185546257553306305e+03,
                              1.187264466187971266e+03,
                              1.188899084291383815e+03,
                              1.190447271388300578e+03,
                              1.191915926924872338e+03,
                              1.193319737758711426e+03,
                              1.194678600930124958e+03,
                              1.196015259635843904e+03,
                              1.197353383946093572e+03,
                              1.198716014432143083e+03,
                              1.200124299405628335e+03,
                              1.201596523015392449e+03,
                              1.203147232934909880e+03,
                              1.204785927324651766e+03,
                              1.206515065794055317e+03,
                              1.208328184938852246e+03,
                              1.210209325036755672e+03,
                              1.212134186727264023e+03,
                              1.214072564424555821e+03,
                              1.215991634344295107e+03,
                              1.217859924098490183e+03,
                              1.219651355085316709e+03,
                              1.221348347231579055e+03,
                              1.222943377272918497e+03,
                              1.224438906482248740e+03,
                              1.225845915773437355e+03,
                              1.227181682206336745e+03,
                              1.228467502606174776e+03,
                              1.229726648107035771e+03,
                              1.230982554245690153e+03,
                              1.232257318540580400e+03,
                              1.233570585139156265e+03,
                              1.234938723731916980e+03,
                              1.236373845246744850e+03,
                              1.237882082229561547e+03,
                              1.239461480658640085e+03,
                              1.241100806077440893e+03,
                              1.242780079664332789e+03,
                              1.244472571612465799e+03,
                              1.246147714644809412e+03,
                              1.247774812001287046e+03,
                              1.249327272811945477e+03,
                              1.250786271782761560e+03,
                              1.252142776299640218e+03,
                              1.253397871089208365e+03,
                              1.254561733385254684e+03,
                              1.255651627351062416e+03,
                              1.256689550282855180e+03,
                              1.257700134411496720e+03,
                              1.258708929344970329e+03,
                              1.259740952601362096e+03,
                              1.260819561501147973e+03,
                              1.261965662911625031e+03,
                              1.263196788565533552e+03,
                              1.264525372250581768e+03,
                              1.265956540678329930e+03,
                              1.267486769618524704e+03,
                              1.269104243660190150e+03,
                              1.270790665405547315e+03,
                              1.272523951897822371e+03,
                              1.274281596342141256e+03,
                              1.276044622844317018e+03,
                              1.277801429489812108e+03,
                              1.279550325206731713e+03,
                              1.281300217886379414e+03,
                              1.283069868204198428e+03,
                              1.284886244948688955e+03,
                              1.286782307712723650e+03,
                              1.288794653381033640e+03,
                              1.290961436308193697e+03,
                              1.293320715554847084e+03,
                              1.295909207532912660e+03,
                              1.298761298732640171e+03,
                              1.301907997577952301e+03,
                              1.305375328541074396e+03,
                              1.309182081668124738e+03,
                              1.313337864621212248e+03,
                              1.317842663260206336e+03,
                              1.322688179334631968e+03,
                              1.327860385087614304e+03,
                              1.333342802035822842e+03,
                              1.339120369586935340e+03,
                              1.345183454018997281e+03,
                              1.351530938205651182e+03,
                              1.358171587269400106e+03,
                              1.365123671796223789e+03,
                              1.372413235736865772e+03,
                              1.380071659402343130e+03,
                              1.388133242350269484e+03,
                              1.396633102302891984e+03,
                              1.405605433027536037e+03,
                              1.415082209591042329e+03,
                              1.425092269084054806e+03,
                              1.435660473079518169e+03,
                              1.446806469918616813e+03,
                              1.458542697322146296e+03,
                              1.470872236367108371e+03,
                              1.483787891077301310e+03,
                              1.497273081894388724e+03,
                              1.511303987091749377e+03,
                              1.525852403666875716e+03,
                              1.540889374215497128e+03,
                              1.556389340099058927e+03,
                              1.572333707028240951e+03,
                              1.588712719194766805e+03,
                              1.605525460153976610e+03,
                              1.622778438675134339e+03,
                              1.640483353501784677e+03,
                              1.658654691180406189e+03,
                              1.677307612580296791e+03,
                              1.696456180704359213e+03,
                              1.716111875572771623e+03,
                              1.736282405677663746e+03,
                              1.756970745421346919e+03,
                              1.778174071587251319e+03,
                              1.799882130845624260e+03,
                              1.822075171964955189e+03,
                              1.844722571543337381e+03,
                              1.867783203242296395e+03,
                              1.891207430131105866e+03,
                              1.914940045939664969e+03,
                              1.938923951714399436e+03,
                              1.963104395712703536e+03,
                              1.987432886271796178e+03,
                              2.011869752378023122e+03,
                              2.036385009366004851e+03,
                              2.060957668397511497e+03,
                              2.085573878228804915e+03,
                              2.110224608096441443e+03,
                              2.134903504769834399e+03,
                              2.159605129151718302e+03,
                              2.184323528243222881e+03,
                              2.209051094057311275e+03,
                              2.233777722244979486e+03,
                              2.258489987050250420e+03,
                              2.283169678301174827e+03,
                              2.307791695966893258e+03,
                              2.332322381992215014e+03,
                              2.356719327843162318e+03,
                              2.380932777155839176e+03,
                              2.404908139656290587e+03,
                              2.428589279680479194e+03,
                              2.451922496773875082e+03,
                              2.474860601525152560e+03,
                              2.497365917711179463e+03,
                              2.519411559257067893e+03,
                              2.540981102649457171e+03,
                              2.562066951001697362e+03,
                              2.582667906556771413e+03,
                              2.602786737550516591e+03,
                              2.622428232848556945e+03,
                              2.641597738575493622e+03,
                              2.660300041115237946e+03,
                              2.678538509897916811e+03,
                              2.696314238482326800e+03,
                              2.713624641792388502e+03,
                              2.730461355793871007e+03,
                              2.746808329869623776e+03,
                              2.762641215372079841e+03,
                              2.777928313075193273e+03,
                              2.792632785046183017e+03,
                              2.806715836843604848e+03,
                              2.820140591148674503e+03,
                              2.832876067571734438e+03,
                              2.844900314445847471e+03,
                              2.856202035592689754e+03,
                              2.866780685240910771e+03,
                              2.876645212917739173e+03,
                              2.885811826147112242e+03,
                              2.894301474831221185e+03,
                              2.902137649315620365e+03,
                              2.909344638331836904e+03,
                              2.915946171270482864e+03,
                              2.921964386807967003e+03,
                              2.927419052537751213e+03,
                              2.932326592492472173e+03,
                              2.936698219443692778e+03,
                              2.940537529328743858e+03,
                              2.943839128229807557e+03,
                              2.946589114429340498e+03,
                              2.948766961623857242e+03,
                              2.950348370137620805e+03,
                              2.951309052886292648e+03,
                              2.951629039262389142e+03,
                              2.951296384677678361e+03,
                              2.950309365113407694e+03,
                              2.948676994228541844e+03,
                              2.946418026143456245e+03,
                              2.943558858063220669e+03,
                              2.940131082914630952e+03,
                              2.936169249616681554e+03,
                              2.931708970954548931e+03,
                              2.926785382372747790e+03,
                              2.921431899063924448e+03,
                              2.915679177833651920e+03,
                              2.909554011672617435e+03,
                              2.903077602163155916e+03,
                              2.896263256361125059e+03,
                              2.889114711767064819e+03,
                              2.881626182624499052e+03,
                              2.873784088761481598e+03,
                              2.865569876422184279e+03,
                              2.856963577551571689e+03,
                              2.847947862209114646e+03,
                              2.838511847967874019e+03,
                              2.828653714407043935e+03,
                              2.818381702766252602e+03,
                              2.807713562343926242e+03,
                              2.796674765855993883e+03,
                              2.785296107202265830e+03,
                              2.773611359754436307e+03,
                              2.761655373554289781e+03,
                              2.749462552705281269e+03,
                              2.737065557250431993e+03,
                              2.724494291241866449e+03,
                              2.711775050210579593e+03,
                              2.698929199219141083e+03,
                              2.685971104607286634e+03,
                              2.672906214100740726e+03,
                              2.659730520573397371e+03,
                              2.646431752106117074e+03,
                              2.632991817592032930e+03,
                              2.619390033695670354e+03,
                              2.605606892044749657e+03,
                              2.591627902504279064e+03,
                              2.577446674497207823e+03,
                              2.563066544881723530e+03,
                              2.548500547421468127e+03,
                              2.533769919518359529e+03,
                              2.518901774836700497e+03,
                              2.503926741536337431e+03,
                              2.488876928034985212e+03,
                              2.473784212809307064e+03,
                              2.458678881156247371e+03,
                              2.443588570731045365e+03,
                              2.428537299691185581e+03,
                              2.413544178254983763e+03,
                              2.398621503467134971e+03,
                              2.383772831988848793e+03,
                              2.368992269046829279e+03,
                              2.354265308734263726e+03,
                              2.339570669204671958e+03,
                              2.324882935921315948e+03,
                              2.310176218200023868e+03,
                              2.295428483740009142e+03,
                              2.280625363891077541e+03,
                              2.265762308451481658e+03,
                              2.250844908722397577e+03,
                              2.235887726045036288e+03,
                              2.220912075388638186e+03,
                              2.205943467923734715e+03,
                              2.191009386217551764e+03,
                              2.176137543478458610e+03,
                              2.161354403853974418e+03,
                              2.146683902892202241e+03,
                              2.132146517717140341e+03,
                              2.117758377965973523e+03,
                              2.103529672127434878e+03,
                              2.089462469505012450e+03,
                              2.075549200732748886e+03,
                              2.061772807117309185e+03,
                              2.048108530621322643e+03,
                              2.034526755214624018e+03,
                              2.020996595899450085e+03,
                              2.007490019133695796e+03,
                              1.993985659874086650e+03,
                              1.980471374792817187e+03,
                              1.966945131629188154e+03,
                              1.953414305257826754e+03,
                              1.939893814303220324e+03,
                              1.926403761559706481e+03,
                              1.912967162596127991e+03,
                              1.899608021908518822e+03,
                              1.886349738641424892e+03,
                              1.873213853440866842e+03,
                              1.860219145124658780e+03,
                              1.847380702021869865e+03};

/* Private variables -------------------------------------------------- */

/* Private function prototypes ---------------------------------------- */
static void read_csv_file(const char *file_name, int *csv_buf, int samples);
static uint32_t peak_detector(double *input);
/* Function definitions ----------------------------------------------- */
int main(void)
{
  // read_csv_file(data_file, sample, MAX_SAMPLES);
  // for (int i = 0; i < MAX_SAMPLES; i++)
  // {
  //   printf("%s\n", sample[i]);
  // }

  printf("%d\n", peak_detector(sample));

  return 0;
}
/* Private definitions ------------------------------------------------ */
static void read_csv_file(const char *file_name, int *csv_buf, int samples)
{
  FILE *sample_file = fopen(file_name, "r");
  if (!sample_file)
  {
    printf("\r\nCould not open file\r\n");
    return;
  }
  char temp[30];
  while (fgets(temp, 30, sample_file))
  {
    double salary = strtod(temp, NULL);
    *csv_buf = (int)salary;
    csv_buf++;

    if (samples-- < 0)
    {
      break;
    }
  }
  fclose(sample_file);
}

static uint32_t peak_detector(double *input)
{
  // Choose the Windows Size W1, W2 in TERMA framework
  uint32_t w_cycle = 301,
           w_evt = 51;

  float ma_cycle[MAX_SAMPLES] = {0},
        ma_evt[MAX_SAMPLES] = {0};

  float mean_of_signal = 0;
  int i, j, k;

  // Enhance the signal
  for (i = 0; i < MAX_SAMPLES; i++)
  {
    input[i] = pow(input[i], 2);
  }

  // Calculate the Event Duration Moving Average
  k = ((w_evt - 1) / 2);
  for (i = ((w_evt - 1) / 2); i < MAX_SAMPLES - ((w_evt - 1) / 2); i++)
  {
    for (j = -((w_evt - 1) / 2); j < k; j++)
    {
      ma_evt[i] += input[i + j];
    }
    ma_evt[i] /= w_evt;
  }

  // Calculate the Event Cycle Moving Average
  k = ((w_cycle - 1) / 2);
  for (i = ((w_cycle - 1) / 2); i < MAX_SAMPLES - ((w_cycle - 1) / 2); i++)
  {
    for (j = -((w_cycle - 1) / 2); j < k; j++)
    {
      ma_cycle[i] += input[i + j];
    }
    ma_cycle[i] /= w_cycle;
  }

  // Calculate the mean of signal
  for (i = 0; i < MAX_SAMPLES; i++)
  {
    mean_of_signal += input[i];
  }

  mean_of_signal /= MAX_SAMPLES;

  // Calculate the Threshold for generating Block of Interest
  float beta = 0.8;
  float threshold_1[MAX_SAMPLES] = {0};

  for (i = 0; i < MAX_SAMPLES; i++)
  {
    threshold_1[i] = ma_cycle[i] + beta * mean_of_signal;
  }

  // Generate the Bloock of Interest
  uint8_t block_of_interest[MAX_SAMPLES] = {0};
  for (i = 0; i < MAX_SAMPLES; i++)
  {
    if (ma_evt[i] > threshold_1[i])
    {
      block_of_interest[i] = 1;
    }
    else
    {
      block_of_interest[i] = 0;
    }
  }

  // Peak detector
  uint32_t pos_start_block = 0;
  uint32_t pos_stop_block = 0;
  uint32_t peak_num = 0;
  for (i = 0; i < MAX_SAMPLES - 1; i++)
  {
    if ((block_of_interest[i + 1] - block_of_interest[i]) == 1)
    {
      pos_start_block = i;
    }
    else if ((block_of_interest[i] - block_of_interest[i + 1]) == 1)
    {
      pos_stop_block = i;
      if (pos_stop_block - pos_start_block >= w_evt)
      {
        /// can calculate peak value to consider histogram
        peak_num++;
      }
    }
  }
  return peak_num;
}
/* End of file -------------------------------------------------------- */
